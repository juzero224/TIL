# 11_다중회귀분석



- 다중회귀분석
  - 독립변수가 두 개 이상인 경우
  - 여러 개의 독립변수를 이용하면 종속변수의 변화를 더 잘 설명할 수 있음
  - 오차 가정 : 정규, 등분산, 독립
  - 회귀계수 베타 해석 : partial effect



- 회귀모형은 범주형 독립변수 포함 가능 (-> 더미 변수 이용)
  - 더미변수의 개수 = 범주의 개수 -1



## 다중선형 회귀모형

### 다중선형회귀모형으로 확장

- 다중 선형회귀모형

  - 독립변수가 두 개 이상인 선형회귀모형

  - 여러 개의 독립변수를 이용하면 종속변수의 변화를 더 잘 설명할 수 있음

  - 자료((𝑥1𝑖, 𝑥2𝑖, ⋯ , 𝑥𝑘𝑖), 𝑌𝑖) , 𝑖 = 1, ⋯ , 𝑛 에 다음의 관계식이 성립한다고 가정
    $$
    Y_i = \alpha + \beta_1x_{1i} + \beta_2x_{2i} + ... + \beta_kx_{ki} + \varepsilon_i\ (i=1,2,...,n)
    $$



- 오차항인 𝜀1, 𝜀2, ⋯, 𝜀𝑛 는서로 독립인 확률변수로, **𝜀𝑖~𝑁[0,𝜎^2]** 

  : **정규, 등분산, 독립가정**

- 회귀계수 α, 𝛽1, … , 𝛽𝑘, 와𝜎^2 은 미지인 모수로 상수임

  - **𝛽𝑗** 의 해석 : 𝑥𝑗 를 제외한 **나머지 모든 예측 변수들을** ==**상수로 고정시킨 상태**== <!--단순선형회귀와의 차이-->에서 **𝑥𝑗의 한 단위 증가에 따른 E[𝑌] 의 증분**을 의미 (𝑗 = 1, … , k)

    - ex. 임금 = a + b1학력 + b2 경력 + e 라고 할 때,

      학력이 똑같은 사람만 모아놓고 봤을 때, 경력을 다르게 두는 것

      경력이 한 단위 증가하면 임금이 평균적으로 얼마나 증가하는 가

      학력을 고정시켜 놓고 임금에 미치는 학력에 영향을 뺀 Partial Effect가 b2만큼 반응한다는 의미



### 회귀계수 𝛼, 𝛽1, … , 𝛽k 의 추정

- 수직거리 제곱합
  $$
  SS(\alpha, \beta) = \sum_{i=1}^n (y_i - \alpha - \beta_1 x_{1i} - ...-\beta_k x_{1k})^2
  $$
  이 최소가 되도록  𝛼, 𝛽1, … , 𝛽𝑘 를 추정

- 최소제곱 추정량
  $$
  \hat{\alpha}, \hat{\beta_1},...,\hat{\beta_k}
  $$
  ![image-20221028233123588](C:/Users/yes47/AppData/Roaming/Typora/typora-user-images/image-20221028233123588.png)



### 예시

- 현재 영업중인 La Quinta lnn 호텔 중에서 랜덤하게 100곳의 영업자료를 수집

- 다중회귀 모형의 설정

  ![image-20221028233210877](C:/Users/yes47/AppData/Roaming/Typora/typora-user-images/image-20221028233210877.png)

  - 𝑀𝑎𝑟𝑔𝑖𝑛 = 38.14 − 0.0076𝑁𝑢𝑚𝑏𝑒𝑟 + 1.65𝑁𝑒𝑎𝑟𝑒𝑠𝑡 −0.23𝐷𝑖𝑠𝑡𝑎𝑛𝑐𝑒 +0.020𝑂𝑓𝑓𝑖𝑐𝑒 𝑆𝑝𝑎𝑐𝑒 + 0.21𝐸𝑛𝑟𝑜𝑙𝑙𝑚𝑒𝑛𝑡 + 0.41𝐼𝑛𝑐𝑜𝑚𝑒 
  - 𝛼  = 38.14. 해석하지않음. 
  - 𝛽1= –0.0076. <u>다른 변수는 고정되어 있고</u>, 반경 3마일이내 호텔 객실이 1개 증가하면, 영업이익율은 평균 0.0076% 감소.
  - 𝛽2= 1.65. 다른 변수는 고정되어 있고, 경쟁 호텔과의 거리가 1마일 증가하면, 영업이익율은 평균 1.65% 증가. 
  - 𝛽3= 0.02. 다른 변수는 고정되어 있고, 사무실 면적이 100평방피트 증가하면, 영업이익율은 평균 0.02% 증가 
  - 𝛽4= 0.21. 다른 변수는 고정되어 있고, 대학생 거주자 수가 1000명 증가하면, 영업이익율은 평균 0.21% 증가.
  - 𝛽5= 0.41. 다른 변수는 고정되어 있고, 중간 가구소득이 $1000 높은 지역은, 영업이익율이 평균 0.41% 증가.
  - 𝛽6= -0.23. 다른 변수는 고정되어 있고, 다운타운 중심으로부터 1마일 멀어질수록, 영업이익율은 평균 0.23% 감소.



- 다중선형회귀모형 추정결과
  $$
  R^2 = \frac{SSR}{SST} = 1-\frac{SSE}{SST}= 0.5251
  $$

  - 영업이익율은 6개 설명변수에 의해 52.51% 설명됨



## 범주형 독립변수가 포함된 회귀모형

### 범주형 독립변수가 포함된 회귀모형

- 범주형 독립변수를 회귀모형에 포함하기 위해서는 더미변수 (dummy variable) 기법을 사용

- 더미변수는 0 또는 1의 값을 갖는 변수로 아래와 같이 정의됨

  ![image-20221028233820951](C:/Users/yes47/AppData/Roaming/Typora/typora-user-images/image-20221028233820951.png)

- 최소제곱법을 이용해서 회귀모형을 추정하는 경우에 우리가 가지고 있는 이 독립변수들 간에 완벽한 선형 관계가 존재하면 모수를 추정할 수 없음. 회귀를 추정할 수 없음
- 이 경우 D는 나머지 A, B, C와 완벽한 선형 관계 
- D는 0 0 0 이라는 값을 가짐



- 범주형 독립변수 예시 : 중고차 가격에 관한 예측 모형

  - 중고차 시장에서 차량의 주행거리와 색상이 차량의 가격에 어떤 영향을 미치는지를 파악하고자 2013년형 A 브랜드 중고차 100대에 관한 자료를 수집. 

  - 종속변수 : Price(가격)

  - 독립변수 : Odometer(주행거리)

  - Color(차량색상, 범주형: white/silver/other)

  - Color의 더미 변수: 범주의 수가 3개

    -> 2개의 더미변수(D1, D2)를 생성

    <img src="C:/Users/yes47/AppData/Roaming/Typora/typora-user-images/image-20221028234328591.png" alt="image-20221028234328591" style="zoom:80%;" />

![image-20221028234352393](C:/Users/yes47/AppData/Roaming/Typora/typora-user-images/image-20221028234352393.png)



## 문제

**Q1. 어느 기업의 매출액 Y을 광고비 X1, 제품가격 X2, 원료가격 X3를 이용한 다중선형회귀모형을 적합하고자 한다. 광고비 X1에 대한 회귀계수가 0.3으로 추정된 경우 이를 적절하게 해석한 것은?**

1. 광고비가 1단위 증가하면 매출액의 평균은 0.3 감소할 것으로 추정된다.

2. 광고비가 1단위 증가하면 매출액의 평균은 0.3 증가할 것으로 추정된다.

3. 다른 독립변수는 고정된 상태에서 광고비가 1단위 증가하면 매출액의 평균은 0.3 감소할 것으로 추정된다.

4. **다른 독립변수는 고정된 상태에서 광고비가 1단위 증가하면 매출액의 평균은 0.3 증가할 것으로 추정된다.**



- 다중선형회귀모형의 회귀계수는, 해당 변수 이외 나머지 변수는 상수로 고정된 상태에서 그 변수가 1단위 증가할 때 종속변수가 평균적으로 어느만큼 변하는가를 나타낸다.



**Q2. 어느 데이터에 대하여 다중선형회귀모형을 적합한 결과 총제곱합(SST)는 60, 오차제곱합(SSE)는 15였다고 하자. 이 적합된 회귀모형의 결정계수(r-square)는 얼마인가?**



- $$
  R^2 = \frac{SSR}{SST} = 1-\frac{SSE}{SST}
  $$

- 1 - 15/60 = **0.75**



- 결정계수는 1-SSE/SST로 정의되므로, 1-15/60=0.75가 된다.



**Q3. 근로자의 임금을 학력으로 설명하는 회귀분석을 수행하고자 한다. 근로자의 학력은 중졸, 고졸, 대졸이상의 세 범주로 표현된 범주형 자료라고 할 때, 다음 설명 중 적절하지 않은 것은 무엇인가?**

1. 독립변수가 범주형인 경우 더미변수를 생성하여 분석해야 한다.

2. 독립변수가 가지는 범주의 개수가 3개이므로 더미변수는 2개가 필요하다.

3. **대졸이상인지 중졸인지에 따라 회귀선의 기울기가 달라진다.**

4. 대졸이상인지 중졸인지에 따라 회귀선의 절편이 달라진다. 



- 독립변수가 범주형인 경우 (범주의 개수-1)만큼의 더미변수를 생성하여 분석을 수행한다. 중졸인 경우와 대졸이상인 경우 더미변수값이 1 또는 0이 되며, 이는 회귀선의 기울기가 아니라 **절편에만 영향**을 준다.