# 13_다중회귀분석



- 오차에 대한 분포 가정
  - 정규, 등분산, 독립

- 잔차 분석
  - 오차에 대한 가정이 적절한가
- 다중공선성
  - 독립변수들 간 강한 상관관계가 부정적 영향을 미치는 현상
  - 독립변수들 간에 강한 선형관계 존재
  - 회귀계수 추정 시 추정량의 분산이 커짐
  - 진단방법
    - VIF 계수가 5 또는 10 이상인 경우 다중공선성
  - 해결방법
    - 해당 변수 제거
    - 중복된 변수를 변환하여 새로운 변수 생성



## 가정 위반 검토 및 해결

### 다중회귀모형의 가정 위반 검토 및 해결

- 잔차분석

  - 회귀모형에서의 가정이 적절한 것인가에 대한평가

  1) 오차의 **정규성**
  2) 오차의 **등분산성**
  3) 오차의 **독립성**
  4) 오차는 확률변수로 관찰되지 않는 값이므로, 각 오차에 대응되는 잔차를 관찰한 뒤 잔차들의 분포를 통해 오차에 대한 가정의 적정성을 확인할 수 있음

  ![image-20221029004442602](C:/Users/yes47/AppData/Roaming/Typora/typora-user-images/image-20221029004442602.png)



- 잔차분석 방법
  - 각 가정 별로, 검정을 통한 방법과 그래프를 통한 시각적인 확인 방법이 가능.
  - 시각적 방법을 이용할 경우,
    - 오차의 정규성 위반: 히스토그램, QQ플롯
    - 오차의 등분산성: 잔차산점도
    - 오차의 독립성: 잔차산점도



- QQ플롯을 이용한 오차의 정규성 검토

  ![image-20221029004607048](C:/Users/yes47/AppData/Roaming/Typora/typora-user-images/image-20221029004607048.png)

- 잔차산점도를 이용한 오차의 독립성 등분산성 검토

  ![image-20221029004628600](C:/Users/yes47/AppData/Roaming/Typora/typora-user-images/image-20221029004628600.png)

  - a : 간격이 일정 = 등분산성, 독립성 O

  - b : 잔차가 점차 커짐 = 이분산성

  - c : 마름모꼴. 잔차가 커졌다가 작아짐 = 이분산성

  - d : 가로축이 시간의 흐름에 따라 잔차들을 나열한 거다 -> 잔차가 + - +  = 독립성이 깨진 형태

    ​      x_i 에 대한 잔차를 그린 경우 -> x, y가 선형이 아닐 가능성이 있음



- 가정 위반 시 해결방안
  - 오차의 **정규성 위반**: **변수변환**
  - 오차의 **등분산성**: **가중최소제곱회귀**
  - 오차의 **독립성**: **시계열 분석**

==정변등가독시==



## 다중공선성 진단 및 해결

### 다중공선성
- 다중공선성이란

  - **독립변수들 간**에 **강한 선형관계**가 존재하는 경우
  - 다중회귀모형 분석 시 자주 발생하는 문제 중 하나임.
  - 다중회귀모형에서 회귀계수 추정에 **부정적인 영향**을 미침.

  1) 개별적인 회귀계수 추정의 <u>신뢰성이 떨어져</u> 추정치를 믿을 수 없게 만듦.
  1) 전반적인 모형의 <u>적합성이나 정확도는 크게 변하지 않음.</u>



- 다중공선성 진단방법

  - VIF 계수도출
    $$
    𝑉𝐼𝐹 = \frac{1}{1 − 𝑅_𝑗^2}
    $$
    

    - 𝑅_𝑗^2 : 𝑥𝑗 종속변수로 두고 나머지 독립변수로 설명하는 다중선형회귀모델에서의 결정계수.
      $$
      x_j \sim x_1 + x_2 + ...+x_{j-1}+x_{j+1}+...+x_k
      $$
      

  ![image-20221029005418522](C:/Users/yes47/AppData/Roaming/Typora/typora-user-images/image-20221029005418522.png)

  - VIF 부분이 결국 추정량의 분산을 키우는 효과 = 다중공선성 설명
  - 각각의 독립변수를 자신의 종속변수로 놓고 나머지를 설명변수로 놓고 다중회귀모형 계산한 후 결정계수를 차례차례 구함
  - VIF 커지는 경우가 있는 지 보는 것



- VIF 계수가 5 또는10 이상인 경우 다중공선성이 심각한 것으로 봄



- 다중공선성의 해결책
  - 변수 선택으로 중복된 변수를 제거
  - 주성분 분석 등을 이용하여 중복된 변수를 변환하여 새로운 변수 생성
  - 릿지, 라쏘 등으로 중복된 변수의 영향력을 일부만 사용



## 문제



**Q1. 선형회귀모형에서 오차에 대한 어떤 가정이 위반된 경우에 가중최소제곱(WLS) 방법을 고려하는가?**

1. 오차의 정규성 

2. **오차의 등분산성**

3. 오차의 기대값은 0

4. 오차의 독립성



==정변등가독시==

- 가중최소제곱은 오차의 등분산성이 위반된 경우의 해결방안이다. 독립성이 위반된 경우는 시계열 분석을 적용하며, 정규성이 위반된 경우는 변수변환을 적용한다




**Q2. 다중선형회귀모형에서 다중공선성(multicollinearity)에 대한 설명으로 잘못된 것은?**

1. 주성분분석(PCA)를 이용하여 해결할 수 있다.

2. **적절한 다중회귀모형은 다중공선성이 존재한다.**

3. 변수선택이 해결방안이 될 수 있다.

4. 다중공선성이 심할수록 회귀계수 추정의 정확도가 낮아진다.



- 다중회귀모형은 독립변수 간 상관관계가 어느정도 존재하는 경우가 많지만, 그 상관관계가 너무 강한 상태를 다중공선성이라고 하며, 다중공선성이 진단되는 모형은 적절한 모형으로 볼 수 없다.



**Q3. 다중선형회귀모형에서 다중공선성 문제를 진단하기 위한 지표로 적절한 것은?**

1. **분산팽창요인(VIF)**

2. 회귀계수 추정값의 표준오차

3. 회귀계수 추정값

4. 결정계수



- 어느 독립변수에 대한 분산팽창요인(VIF)는 해당 독립변수를 제외한 나머지 독립변수로 주어진 독립변수를 얼마나 설명할 수 있는지를 반영하는 지표로, 이 값이 5나 10 등으로 큰 값이 나오면 다중공선성이 있는 것으로 진단한다.