# 12_다중회귀분석 (변수선택)



- 가능한 적은 수의 설명변수로 좋은 예측력을 가지는 모형을 추정
- 독립변수들끼리의 중복된 정보가 많은 경우
  - 독립변수에 대한 회귀계수들 추정에 여러 가지 부정적인 영향을 미침



- **다중공선성**
- 변수들을 어떻게 하면 **적은 수의 좋은 변수들**만 남길까
- 가장 적절한 **최적의 독립변수 조합**을 남기는 방법



## 다중회귀모형의 변수선택

### 다중회귀모형의 변수선택 개요

- 가능한 적은 수의 설명변수로 좋은 예측력을 가지는 모형을 찾고자 함
- 변수선택법
  - 전진선택법 (forward selection)
  - 후진제거법 (backward elimination)
  - 단계선택법 (stepwise method)
  - 모든 가능한 조합의 회귀분석 : 모든 가능한 독립변수들의 조합에 대한 회귀모형을 생성한 뒤 가장 적합한 회귀모형을 선택



## 전진선택법

### 변수 선택 방법

- 전진 선택법(Forward selection)

  - 절편만 있는 모델에서 출발하여 중요한 변수를 하나씩 추가하는 방식
  - 한번 선택된 변수는 제거되지 않는 단점이 있음.

  ![image-20221028235252348](C:/Users/yes47/AppData/Roaming/Typora/typora-user-images/image-20221028235252348.png)

- H0 : beta2 = 0 (=> 축소)
- H1 : beta2 ≠ 0 (=> 완전)
- 부분 F검정을 통해 최적의 변수를 찾게 됨



## 후진제거법

### 변수 선택 방법

- 후진제거법 (Backward elimination)

  - 모든 변수가 포함된 모델에서 가장 중요하지 않은 변수부터 하나씩 제거
  - 한번 제거된 변수는 선택되지 않는 단점이 있음

  ![image-20221028235358823](C:/Users/yes47/AppData/Roaming/Typora/typora-user-images/image-20221028235358823.png)



## 단계별 방법

### 변수 선택 방법

- 절편만 포함된 모델에서 출발해 **가장 중요한 변수부터 추가**하고, 모델에 포함되어 있는 변수 중에서 **중요하지 않은 변수를 제거**함.
- 더이상 새롭게 추가되는 변수가 없을 때까지 변수의 추가 또는 삭제를 반복함.

![image-20221028235450431](C:/Users/yes47/AppData/Roaming/Typora/typora-user-images/image-20221028235450431.png)



### 모형선택 기준

- 수정된 결정계수(Adjusted 𝑅^2)

  - 결정계수 𝑅2 는 새로운 독립변수가 추가되면 항상 증가함.

  - 이를 보완한 수정 결정계수 𝐴𝑑𝑗𝑢𝑠𝑡𝑒𝑑 𝑅2 는 **추가된 독립변수가 종속변수를 설명하는데 기여하는 바가 큰 경우에만 증가**함.
    $$
    𝐴𝑑𝑗𝑢𝑠𝑡𝑒𝑑\ 𝑅^2 = 1 − \frac{𝑆𝑆𝐸/(𝑛 − 𝑘 − 1)}{𝑆𝑆𝑇/(𝑛 − 1)}
    $$

    - 새로운 독립변수가 모형에 포함되었을 때 수직거리 제곱합을 더 줄일 수 있는 소지가 있고 추정된 애는 원래 수직거리 제곱합에 비해 수정된 수직거리 제곱합이 더 줄어듦 
    - 수직거리 제곱합(SSE)이 줄어듦에 따라 R-squared는 증가하게 됨
    - 불필요한 변수가 추가되도 R-squared는 개선이 되기 때문에 최적의 독립변수 조합을 남길 수 없음
    - 이를 보완하기 위해 수정 결정계수를 사용

- 그 밖에 AIC, BIC, Mallow’s Cp 등의 다양한 적합도 지표를 이용할 수 있음.



## 문제

**Q1. 회귀모형에서 변수선택법 가운데 후진제거법(backward elimination)에 관한 설명으로 적절하지 않은 것은?**

1. 초기 모형은 모든 독립변수가 포함된 모형이다.

2. **한번 제거된 변수도 경우에 따라 다시 선택될 수 있다.**

3. 독립변수는 한번에 하나씩 제거된다.

4. 독립변수가 제거될 때마다 모델을 다시 적합한다.



- 한번 제거된 변수가 다시 선택되는지를 고려하는 방법은 단계선택법에 해당한다.





**Q2. 절편만 포함된 모형에서 출발하여, 종속변수를 설명하기에 가장 중요한 독립변수부터 하나씩 모형에 추가하되, 새로운 변수가 모형에 추가되는 매 단계마다 모형에 포함되어 있던 변수 중 더 이상 중요하지 않은 변수가 있는지 파악하여 이를 제거하는 변수선택법을 무엇이라고 하는가?**

1. 전진선택법

2. 후진제거법

3. **단계선택법**

4. 모든 가능한 조합을 탐색하는 방법



- 제시된 설명은 단계선택법에 관한 것으로, 모든 가능한 조합을 탐색하지 않고도 독립변수들의 상호작용이 고려된 최적의 조합을 빠르게 찾을 수 있다는 점에서 가장 선호되는 변수선택법이다.



**Q3. 다음은 회귀모형의 다양한 적합도 지표에 관한 설명이다. 잘못된 것은 무엇인가?**

1. 결정계수는 종속변수의 총 변동 중 적합된 회귀모형으로 설명되는 변동의 비율을 의미한다.

2. **종속변수를 잘 설명하지 못하는 독립변수가 추가되는 경우에도 수정결정계수는 항상 증가한다.**

3. AIC 값이 작을수록 적합도가 높은 것이다.

4. 동일한 모형과 자료에 대하여 결정계수보다 수정결정계수의 값이 항상 더 작다.



- 종속변수를 잘 설명하지 못하는 독립변수가 추가되는 경우에 결정계수는 항상 증가하지만, 수정결정계수의 경우는 그렇지 않다. 수정결정계수는 새로운 독립변수의 추가로 SSE/(n-k-1)가 감소하는 경우에만 증가한다. 또한 결정계수는 1-(SSE/SST)이고, 수정결정계수는 1-(n-1)/(n-k-1)*(SSE/SST)이므로 동일한 조건에서 결정계수보다 항상 조금 더 작은 값이 된다.